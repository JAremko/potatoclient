syntax = "proto3";

package test.validate;

import "buf/validate/validate.proto";

// Test message with various buf.validate constraints
message ValidatedTypes {
  // Numeric constraints
  double velocity = 1 [(buf.validate.field).double = {gte: -1.0, lte: 1.0}];
  float temperature = 2 [(buf.validate.field).float = {gt: -273.15}];
  int32 count = 3 [(buf.validate.field).int32 = {gte: 0, lte: 100}];
  int64 timestamp = 4 [(buf.validate.field).int64 = {gt: 0}];
  uint32 port = 5 [(buf.validate.field).uint32 = {gte: 1, lte: 65535}];
  
  // String constraints
  string email = 6 [(buf.validate.field).string = {
    email: true,
    min_len: 5,
    max_len: 100
  }];
  
  string username = 7 [(buf.validate.field).string = {
    pattern: "^[a-zA-Z0-9_]+$",
    min_len: 3,
    max_len: 20
  }];
  
  string constant_value = 8 [(buf.validate.field).string = {const: "FIXED_VALUE"}];
  
  // Bytes constraints
  bytes data = 9 [(buf.validate.field).bytes = {
    min_len: 10,
    max_len: 1024
  }];
  
  // Enum constraints
  Status status = 10 [(buf.validate.field).enum = {
    defined_only: true,
    not_in: [0]
  }];
  
  // Repeated field constraints
  repeated string tags = 11 [(buf.validate.field).repeated = {
    min_items: 1,
    max_items: 10,
    unique: true
  }];
  
  // Map constraints
  map<string, int32> properties = 12 [(buf.validate.field).map = {
    min_pairs: 1,
    max_pairs: 50
  }];
  
  // Message field with required constraint
  NestedMessage nested = 13 [(buf.validate.field).required = true];
  
  // Oneof with required
  oneof action {
    option (buf.validate.oneof).required = true;
    
    CreateAction create = 14;
    UpdateAction update = 15;
    DeleteAction delete = 16;
  }
}

enum Status {
  UNKNOWN = 0;
  ACTIVE = 1;
  INACTIVE = 2;
  PENDING = 3;
}

message NestedMessage {
  string name = 1 [(buf.validate.field).string = {min_len: 1}];
  optional int32 value = 2;
}

message CreateAction {
  string resource_name = 1 [(buf.validate.field).string = {min_len: 1}];
}

message UpdateAction {
  int32 resource_id = 1 [(buf.validate.field).int32 = {gt: 0}];
  map<string, string> updates = 2;
}

message DeleteAction {
  int32 resource_id = 1 [(buf.validate.field).int32 = {gt: 0}];
  optional bool force = 2;
}